<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<link rel="stylesheet"  href="./static/layui/css/layui.css" type="text/css"/
<script src="./static/jszip.js"></script>
<script src="./static/FileSaver.min.js"></script>
<script src="./static/xlsx.js"></script>

<body>
<div>
<!--    <script src="./static/layui/layui.js"></script>-->
    <!-- 导航栏 -->
    <div>

        <ul class="layui-nav" lay-filter="">
          <li class="layui-nav-item"><a href="">最新活动</a></li>
          <li class="layui-nav-item layui-this"><a href="">产品</a></li>
          <li class="layui-nav-item"><a href="">大数据</a></li>
          <li class="layui-nav-item">
            <a href="javascript:;">解决方案</a>
            <dl class="layui-nav-child"> <!-- 二级菜单 -->
              <dd><a href="">移动模块</a></dd>
              <dd><a href="">后台模版</a></dd>
              <dd><a href="">电商平台</a></dd>
            </dl>
          </li>
          <li class="layui-nav-item"><a href="">社区</a></li>
        </ul>
    </div>
    <!--    -->
    <div>
        <form class="layui-form">
            <div class="layui-form-item">
                <label class="layui-form-label">输入框</label>
                <div class="layui-input-block">
                  <input type="text" name="" placeholder="请输入" autocomplete="off" class="layui-input">
                </div>
              </div>
        </form>
    </div>
</div>
<script src="./static/layui/layui.all.js"></script>
<!--<script src="./static/layui/layui.js"></script>-->
<script>
    layui.use('element', function(){
      var element = layui.element;
    });
    function save_zip() {
        var zip = new JSZip();
        zip.file("Hello.txt", "Hello World\n");

        var file = XLSX.read("E:\\python_project\\test.xlsx",{ type: "base64" })
        console.log(file)
        // 通过编写一个接口，Django后端读取文件并将内容返回给前端，前端重新写入csv文件
        var str = "序号,标题,操作类型,操作内容,操作时间\n"
        let i = 0
        while (i<=10){
          i++
          str += `1,2,3,4,5,\n`
        }
        zip.file("hhh.csv",str)
        var img = zip.folder("images");
        img.file("smile.gif", imgData, {base64: true});
        zip.generateAsync({type:"blob"}).then(function(content) {
            // see FileSaver.js
            saveAs(content,"example.zip");
        });
    }

    window.form = layui.form
    form.render();


</script>
</body>
<!--<script src="./static/layui/layui.all.js"></script>-->
<!--<script>-->
<!--    layui.use('element', function(){-->
<!--      var element = layui.element;-->
<!--    });-->
<!--    function save_zip() {-->
<!--        var zip = new JSZip();-->
<!--        zip.file("Hello.txt", "Hello World\n");-->

<!--        var file = XLSX.read("E:\\python_project\\test.xlsx",{ type: "base64" })-->
<!--        console.log(file)-->
<!--        // 通过编写一个接口，Django后端读取文件并将内容返回给前端，前端重新写入csv文件-->
<!--        var str = "序号,标题,操作类型,操作内容,操作时间\n"-->
<!--        let i = 0-->
<!--        while (i<=10){-->
<!--          i++-->
<!--          str += `1,2,3,4,5,\n`-->
<!--        }-->
<!--        zip.file("hhh.csv",str)-->
<!--        var img = zip.folder("images");-->
<!--        img.file("smile.gif", imgData, {base64: true});-->
<!--        zip.generateAsync({type:"blob"}).then(function(content) {-->
<!--            // see FileSaver.js-->
<!--            saveAs(content,"example.zip");-->
<!--        });-->
<!--    }-->

<!--    window.form = layui.form-->
<!--    form.render();-->


<!--</script>-->

</html>